<!DOCTYPE html>
<html lang="en" ng-app="CarIssues">
  <head>
    <title>Car Issues</title>
    <link rel="stylesheet" href="/styles/bootstrap.min.css"/>
    <link rel="stylesheet" href="/styles/animate.css">
    <link rel="stylesheet" href="/styles/bootstrap-select.min.css">
    
    <style type="text/css">
    body{
    background: url("/imgs/footer_lodyas.png");
    }
    .jumbotron{
    background: url("/imgs/debut_dark.png");
    color: #F4F4F4;
    text-shadow: 2px 3px 3px #000;
    }
    select{
    height: 30px;
    margin: 5px;
    color: #46494C;
    }
    p#headline{
    font-size: 2.2em;
    }
    #headline_text, #headline{
    font-size: 1.3em;
    font-weight: bold;
    text-shadow: 2px 3px 2px #000;
    color: #F4F4F4;
    padding-left: 20px;
    }
    h4{
    color: #F4F4F4;
    font-weight: bold;
    text-shadow: 2px 3px 2px #000;
    padding-left: 20px;
    }
    select, option{
    width: 150px;
    }
    #makes_div, #models_div, #years_div{
    width: auto;
    padding-top: 10px;
    }
    td{
    font-size:1.1em;
    }
    th{
    font-size:1.2em;
    color: #F4F4F4;
    }
    #no_issues{
    font-size: 1.4em;
    text-align: center;
    margin:10px 0px;
    padding: 40px 35px;
    color: #46494C;
    background: -webkit-linear-gradient(#F4F4F4, #C5C3C6); /* For Safari 5.1 to 6.0 */
    background: -o-linear-gradient(#F4F4F4, #C5C3C6); /* For Opera 11.1 to 12.0 */
    background: -moz-linear-gradient(#F4F4F4, #C5C3C6); /* For Firefox 3.6 to 15 */
    background: linear-gradient(#F4F4F4, #C5C3C6); /* Standard syntax */
    border: -webkit-border-radius: 20px;
    border: -moz-border-radius: 20px;
    border-radius: 20px;
    }
    td#styles_options:hover{
    text-decoration: underline;
    cursor: pointer;
    color: #1985A1; /*off-blue*/
    }
    #styles_div, #issues_div{
    margin: 0px 20px;
    padding: 15px 35px 15px;
    }
    #styles_div{
      border-bottom: 2px solid #F4F4F4;
    }
    #styles_div.ng-hide-remove, #issues_div.ng-hide-remove{
    -webkit-animation: slideInUp 0.5s;
    animation: slideInUp 0.5s;
    }
    #styles_div.ng-hide-add, #issues_div.ng-hide-add{
    --webkit-animation: 0.5s slideOutDown;
    animation: 0.5s slideOutDown;
    }
    select.form-control{
    background-color: #F4F4F4;
    text-align: left;
    font-size: 1.2em;
    color: #46494C;
    }
    .btn{
    margin: 20px;
    font-size: 1.2em;
    }
    .alert-success{
      background-color: #2A9FD6;
      border-color: #2A9FD6;
      margin-left: 20px;
    }
    .alert{
      margin-bottom: 0px;
    }
    .alert>p{
      font-size: 1.05em;
    }
    #selections_div{
    margin:15px 20px;
    padding: 50px 35px 60px;
    background: -webkit-linear-gradient(#4C5C68, #46494C); /* For Safari 5.1 to 6.0 */
    background: -o-linear-gradient(#4C5C68, #46494C); /* For Opera 11.1 to 12.0 */
    background: -moz-linear-gradient(#4C5C68, #46494C); /* For Firefox 3.6 to 15 */
    background: linear-gradient(#4C5C68, #46494C); /* Standard syntax */
    border: -webkit-border-radius: 20px;
    border: -moz-border-radius: 20px;
    border-radius: 20px;
    }
    .table-striped>tbody>tr:nth-child(odd)>td{
    background-color: #F4F4F4;
    color: #46494C;
    }
    .table-striped>tbody>tr:nth-child(odd)>th {
    color: #F4F4F4;
    }
    .table-striped>tbody>tr:nth-child(even)>td{
    background-color: #46494C;
    color: #F4F4F4;
    }
    .table-striped>thead>tr{
    background-color: #46494C;
    color: #F4F4F4;
    }
    #votes{
    }
    .modal-content{
    background-color: #F4F4F4;
      color: #46494C;
    }
    #modalText, .modal-title{
    font-weight: bold;
    font-size: 1.2em;
    color: #46494C;
    padding-left: 0px;
    }
    html, body {
    height: 100%;
    }
    .container {
    min-height: 100%;
    }
    #main {
    padding-bottom:150px; /* this needs to be bigger than footer height*/
    }
    .footer {
    color: #F4F4F4;
    position: relative;
    margin-top: -250px; /* negative value of footer height */
    height: 100px;
    clear:both;
    padding-top:200px;
    text-align: center;
    }
    .badge#votes_negative{
      background-color: #D63230;
    }
    .voteBtns{
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    background-color: transparent;
    background-repeat: no-repeat;
    border: none;
    cursor: pointer;
    overflow: hidden;
    outline: none;
    }
    </style>
  </head>
  <body>
    
    
    <div class='container clear-top'>
      
      <div class='col-xs-12' id="main" ng-controller="carController">
        
        <div class="alert alert-dismissible alert-success" ng-show="showAlert">
          <button type="button" class="close" data-dismiss="alert"><span class="glyphicon glyphicon-remove"></span></button>
          <p><strong>Thank you for your submission!</strong> The car community appreciates your feedback!</p>
        </div>
        
        <div id="selections_div" class="col-xs-12 text-left" > <!-- Selections Div -->
        <p id="headline">Crowd-Sourced Car Issues</p>
        <p id="headline_text">Find out if your car has any known issues today. <br>Select a Make to get started now!</p>
        <div id="makes_div"  class="col-md-3">
          <select class="form-control" ng-change="getModels(makeName)" ng-model="makeName" ng-options="make.name as make.name for make in makes" >
            <option value=''>Select Make</option>
          </select>
          <!-- {{error1}} -->
          </div><!--  end makes -->
          
          <div  id="models_div" class="col-md-3" >
            <select  id="models_select" class="form-control" ng-change="getYears(makeModels, makeName)" ng-model="makeModels" ng-options="model.name as model.name for model in models" ng-disabled="!makeName">
              <option value=''>Select Model</option>
            </select>
            <!--  {{error2}} --> <!-- hide error -->
            </div> <!-- end models -->
            
            <div  id="years_div"  class="col-md-3">
              <select  class="form-control" ng-change="getStyles(makeModels, makeName, makeYears)" ng-model="makeYears" ng-options="year.year as year.year for year in years" ng-disabled="!makeModels">
                <option value=''>Select Year</option>
              </select>
              <!--  {{error3}} -->
              </div> <!-- end years -->
              
              <!-- {{error4}} -->
              </div> <!-- end selection div -->
              
              <div id="styles_div" class="col-xs-12" ng-hide="makeName == null || makeModels == null || makeYears == null">
                <h4>Select A Style:</h4>
                
                <table class="table table-striped" id="styles_table">
                  
                  <tbody>
                    <tr ng-repeat="style in styles" ng-click="getCar(makeModels, makeName, makeYears, style.name)">
                      <td id="styles_options"><span class="glyphicon glyphicon-menu-right"></span> {{style.name}}</td>
                    </tr>
                  </tbody>
                  
                </table>
                
                </div> <!-- end styles div -->
                
                
                <div id="issues_div" class="col-xs-12" ng-hide="car == '' " >
                  
                  <div>
                    <h4 id="car_select">Issues List for: {{car}} </h4>
                  </div>
                  
                  <div id="no_issues" ng-if="car !== issuesCarName ">
                    No Issues Yet, Please Submit Your Own Using The Add New Issue Button Below!
                    </div> <!-- end no_issues div -->
                    <div id="issues_list" ng-if="car === issuesCarName ">
                      <table class="table table-striped">
                        <thead>
                          <tr>
                            <th>
                              <a href="" ng-click="sortType = 'mileage' ; sortReverse = !sortReverse">
                                Mileage
                                <span ng-show="sortType == 'mileage' && !sortReverse" class="dropup">
                                  <span class="caret"></span> <!-- Up -->
                                </span>
                                <span ng-show="sortType == 'mileage' && sortReverse" class="caret"></span> <!-- Down -->
                              </a>
                            </th>
                            <th>Issues</th>
                            <th>
                              <a href="" ng-click="sortType = 'up' ; sortReverse = !sortReverse">
                                Up Votes
                                <span ng-show="sortType == 'up' && !sortReverse" class="dropup">
                                  <span class="caret"></span> <!-- Up -->
                                </span>
                                <span ng-show="sortType == 'up' && sortReverse" class="caret"></span> <!-- Down -->
                              </a>
                            </th>
                            <th><a href="" ng-click="sortType = 'down' ; sortReverse = !sortReverse">
                              Down Votes
                              <span ng-show="sortType == 'down' && !sortReverse" class="dropup">
                                <span class="caret"></span> <!-- Up -->
                              </span>
                              <span ng-show="sortType == 'down' && sortReverse" class="caret"></span> <!-- Down -->
                            </a>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr ng-repeat="issue in issueArr | orderBy:sortType:sortReverse" >

                          <td>{{issue.mileage | number}}</td>
                          <td>{{issue.issueName}}</td>
                          <td>
                            <button class="voteBtns" type="button" ng-disabled="issue.disabled" ng-click="upvote(issue); upStyle={color:'#2A9FD6'} ">
                            <span ng-style="upStyle" class="glyphicon glyphicon-thumbs-up"></span>&nbsp;
                            <span id="votes" class="badge">{{issue.up}}</span>
                            </button>
                          </td>
                          <td>
                            <button class="voteBtns" type="button"  ng-disabled="issue.disabled" ng-click="downvote(issue); downStyle={color:'#D63230'} " >
                            <span ng-style="downStyle" class="glyphicon glyphicon-thumbs-down"></span>&nbsp; 
                            <span id="votes_negative" class="badge">{{issue.down}}</span>
                          </button>
                          </td>

                        </tr>
                        
                      </tbody>
                      
                    </table>

                    </div><!--  end issues_list div -->
                    <button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#newIssueModal"><span class="glyphicon glyphicon-edit"></span> Add New Issue</button>
                    <!-- <button class="btn btn-danger btn-lg"><span class="glyphicon glyphicon-ban-circle"></span> Report An Issue</button> --> <!-- ******Thinking about this feature ********-->
                    
                    </div> <!-- end issues div -->
                    
                    <!-- Modal -->
                    <div class="modal animated fadeInDown" id="newIssueModal" role="dialog">
                      <div class="modal-dialog">
                        
                        <!-- Modal content-->
                        <div class="modal-content">
                          <div class="modal-header">
                            <h3 class="modal-title">Add New Issue for: {{car}}</h3>
                          </div>
                          <div class="modal-body">
                            <form name="IssueForm" novalidate ng-submit="addNewIssue(car)" onsubmit="parent.scrollTo(0, 0); return true" ><!-- on submit scroll page to top to see alert dialog for success  -->
                            <div class="form-group">
                              <label for="inputMileage"><p id="modalText">Mileage:</p></label>
                              <input type="number" class="form-control" ng-model="IssueMileage" ng-minlength="3" ng-maxlength="9" min="100" max="999999" id="inputMileage" placeholder="eg. 15000" ng-required="true"/>
                            </div>
                            <div class="form-group">
                              <label for="inputIssue"><p id="modalText">Issue:</p></label>
                              <input type="text" class="form-control" ng-minlength="2" maxlength="90" ng-model="IssueText" id="inputIssue" placeholder="eg. OEM Transfer Case Replaced" ng-required="true"/>
                            </div>
                            
                            <button type="submit" class="btn btn-primary" ng-disabled="IssueForm.$invalid" onclick="$('#newIssueModal').modal('hide')"><span class="glyphicon glyphicon-ok"></span> Submit</button>
                            <button type="button" class="btn btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                          </form>
                          </div> <!-- end modal body -->
                          <!--  $(function(){
                              setTimeout(function(){
                            $('#newIssueModal').modal('hide');
                              }, 2000);
                          }) --> <!-- add a delay to closing the modal. Problem is the values reset to quickly -->
                          
                          </div> <!-- end modal content -->
                          
                          </div> <!-- end modal dialog -->
                          </div> <!-- end modal -->
                          </div> <!--  End carController div -->
                          
                          </div> <!-- end container -->
                        <footer class="footer">Created by johnTzan</footer>
                        
                        
                      </body>
                      <script src='/js/jquery-1.11.3.min.js'></script>
                      <script src='/js/bootstrap.min.js'></script>
                      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular.min.js"></script>
                      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular-animate.js"></script>
                      <script type="text/javascript" src="/js/controllers/car_controller.js"></script>
                    </html>